buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }
    dependencies {
        classpath 'com.gradle.publish:plugin-publish-plugin:1.2.1'
        classpath 'pl.allegro.tech.build:axion-release-plugin:1.16.1'
        classpath 'com.fizzpod:gradle-extended-info-plugin:12.3.4'
        classpath 'com.fizzpod:gradle-gitignore-plugin:3.0.4'
        classpath 'com.fizzpod:gradle-layout-plugin:4.3.6'
        classpath 'com.fizzpod:gradle-sweeney-plugin:4.6.6'
        classpath 'com.github.ben-manes:gradle-versions-plugin:0.50.0'
        classpath 'com.gradle.enterprise:com.gradle.enterprise.gradle.plugin:3.16'
        classpath 'org.owasp:dependency-check-gradle:9.0.2'
        classpath 'com.github.spotbugs.snom:spotbugs-gradle-plugin:6.0.2'
        classpath 'com.fizzpod:gradle-github-release-plugin:0.4.8'
    }
}
apply plugin: 'java'

apply from: './src/main/resources/META-INF/pater-build/com-fizzpod-opinion-gradle-plugin.gradle'
apply from: './src/main/resources/META-INF/pater-build/com-fizzpod-opinion-gradle-plugin-jacoco.gradle'
apply from: './src/main/resources/META-INF/pater-build/com-fizzpod-opinion-gradle-plugin-init.gradle'
apply from: './src/main/resources/META-INF/pater-build/com-fizzpod-opinion-gradle-plugin-publish.gradle'

compileJava {
    options.release = 11
}

compileGroovy {
    options.release = 11
}

dependencies {
    runtimeOnly 'com.gradle.publish:plugin-publish-plugin:1.2.1'
    runtimeOnly 'pl.allegro.tech.build:axion-release-plugin:1.16.1'
    runtimeOnly 'com.fizzpod:gradle-extended-info-plugin:12.3.4'
    runtimeOnly 'com.fizzpod:gradle-gitignore-plugin:3.0.4'
    runtimeOnly 'com.fizzpod:gradle-layout-plugin:4.3.6'
    runtimeOnly 'com.fizzpod:gradle-sweeney-plugin:4.6.6'
    runtimeOnly 'com.fizzpod:gradle-pater-build-plugin:2.5.8'
    runtimeOnly 'com.github.ben-manes:gradle-versions-plugin:0.50.0'
    runtimeOnly 'com.gradle.enterprise:com.gradle.enterprise.gradle.plugin:3.16'
    runtimeOnly 'org.owasp:dependency-check-gradle:9.0.2'
    runtimeOnly 'com.github.spotbugs.snom:spotbugs-gradle-plugin:6.0.2'
    runtimeOnly 'com.fizzpod:gradle-github-release-plugin:0.4.8'
    //Following constraints to avoid CVE Vulns
    constraints {
        implementation('org.apache.sshd:sshd-core') {
            because 'version 2.7.0 defined has a known vuknerability'
            version {
                require '2.9.2'
            }
        }
        implementation('org.apache.sshd:sshd-osgi') {
            because 'version 2.7.0 defined has a known vuknerability'
            version {
                require '2.9.2'
            }
        }
        implementation('org.apache.sshd:sshd-sftp') {
            because 'version 2.7.0 defined has a known vuknerability'
            version {
                require '2.9.2'
            }
        }
        implementation('com.thoughtworks.xstream:xstream') {
            because 'version 1.4.17 defined by ben manes gradle version plugin has known vulnerabilities'
            version {
                require '1.4.20'
            }
        }
        implementation ('org.apache.bcel:bcel') {
            because 'version 6.5.0 defined has a known vuknerability'
            version {
                require '6.7.0'
            }
        }
    }
}
